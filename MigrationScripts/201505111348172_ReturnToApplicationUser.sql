EXECUTE sp_rename @objname = N'dbo.ExpenseUsers', @newname = N'ApplicationUserExpenses', @objtype = N'OBJECT'
IF object_id('[PK_dbo.ExpenseUsers]') IS NOT NULL BEGIN
    EXECUTE sp_rename @objname = N'[PK_dbo.ExpenseUsers]', @newname = N'PK_dbo.ApplicationUserExpenses', @objtype = N'OBJECT'
END
EXECUTE sp_rename @objname = N'dbo.GroupUsers', @newname = N'ApplicationUserGroups', @objtype = N'OBJECT'
IF object_id('[PK_dbo.GroupUsers]') IS NOT NULL BEGIN
    EXECUTE sp_rename @objname = N'[PK_dbo.GroupUsers]', @newname = N'PK_dbo.ApplicationUserGroups', @objtype = N'OBJECT'
END
IF object_id(N'[dbo].[FK_dbo.Transfers_dbo.Users_UserId]', N'F') IS NOT NULL
    ALTER TABLE [dbo].[Transfers] DROP CONSTRAINT [FK_dbo.Transfers_dbo.Users_UserId]
IF EXISTS (SELECT name FROM sys.indexes WHERE name = N'IX_UserId' AND object_id = object_id(N'[dbo].[Transfers]', N'U'))
    DROP INDEX [IX_UserId] ON [dbo].[Transfers]
EXECUTE sp_rename @objname = N'dbo.ApplicationUserExpenses.User_UserId', @newname = N'ApplicationUser_Id', @objtype = N'COLUMN'
EXECUTE sp_rename @objname = N'dbo.ApplicationUserGroups.User_UserId', @newname = N'ApplicationUser_Id', @objtype = N'COLUMN'
EXECUTE sp_rename @objname = N'dbo.ApplicationUserExpenses.IX_User_UserId', @newname = N'IX_ApplicationUser_Id', @objtype = N'INDEX'
EXECUTE sp_rename @objname = N'dbo.ApplicationUserGroups.IX_User_UserId', @newname = N'IX_ApplicationUser_Id', @objtype = N'INDEX'
ALTER TABLE [dbo].[ApplicationUserExpenses] DROP CONSTRAINT [PK_dbo.ApplicationUserExpenses]
ALTER TABLE [dbo].[ApplicationUserGroups] DROP CONSTRAINT [PK_dbo.ApplicationUserGroups]
ALTER TABLE [dbo].[Transfers] ADD [ApplicationUserId] [nvarchar](128) NOT NULL DEFAULT ''
ALTER TABLE [dbo].[ApplicationUserExpenses] ADD CONSTRAINT [PK_dbo.ApplicationUserExpenses] PRIMARY KEY ([ApplicationUser_Id], [Expense_ExpenseId])
ALTER TABLE [dbo].[ApplicationUserGroups] ADD CONSTRAINT [PK_dbo.ApplicationUserGroups] PRIMARY KEY ([ApplicationUser_Id], [Group_GroupId])
CREATE INDEX [IX_ApplicationUserId] ON [dbo].[Transfers]([ApplicationUserId])
ALTER TABLE [dbo].[Transfers] ADD CONSTRAINT [FK_dbo.Transfers_dbo.AspNetUsers_ApplicationUserId] FOREIGN KEY ([ApplicationUserId]) REFERENCES [dbo].[AspNetUsers] ([Id]) ON DELETE CASCADE
DECLARE @var0 nvarchar(128)
SELECT @var0 = name
FROM sys.default_constraints
WHERE parent_object_id = object_id(N'dbo.Transfers')
AND col_name(parent_object_id, parent_column_id) = 'UserId';
IF @var0 IS NOT NULL
    EXECUTE('ALTER TABLE [dbo].[Transfers] DROP CONSTRAINT [' + @var0 + ']')
ALTER TABLE [dbo].[Transfers] DROP COLUMN [UserId]
DROP TABLE [dbo].[Users]
INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
VALUES (N'201505111348172_ReturnToApplicationUser', N'DataAccessLayer.Migrations.Configuration',  0x1F8B0800000000000400E55D596F24B7117E0F90FFD098A72490353AB28B8D306343D6610B591DD8D11A7913A86ECEA8B17D8CBB39B28420BF2C0FF949F90B21FBE4D94DF63D0E0C189A26592C163F168B4556ED7FFFFD9FC50F6FBE67BDC22876C360393B3E3C9A5930B043C70D36CBD90EADBFFB34FBE1FB3FFE6171E5F86FD62F79BD53520FB70CE2E5EC05A1EDD97C1EDB2FD007F1A1EFDA5118876B746887FE1C38E1FCE4E8E86FF3E3E339C424669896652DBEEC02E4FA30F9817F5E84810DB76807BCDBD0815E9C7DC725AB84AA75077C186F810D97B34B80C0B96DC338FE0CDE6134B3CE3D17603656D05BCF2C10042102083379F635862B1485C166B5C51F80F7F8BE85B8DE1A7831CC983F2BABEB8EE3E8848C635E36CC49D9BB1885BE21C1E3D34C3073BE7923F1CE0AC161D15D6111A37732EA447CCBD9D5DB160664EC7C5F67175E44EA09C23D4C68B8303ECCDAC697B89D1BE43F0F2CAEC14101118C24F2DF8175B1F3D02E82CB00EE5004BC03EB61F7ECB9F6DFE1FB63F80D06CB60E77934DF98735CC67CC09F1EA2700B23F4FE05AED9D1DC38336BCE369FF3ED8BD662D374D837013A3D9959779815F0ECC10224948856288CE04F30801140D0790008C108CFF18D0313310B4C705D6230460FE01DAFAAB2578C4EFC7B66DD82B7CF30D8A097E50CFF39B3AEDD37E8E45F324EBE062E5E94B8118A7650C26975EF9730B623779BE26AF0CEB1C0F25EC9DF8F78E11B1339F743AC320A3221C69039919FA270B7AD9F758EC81D787537090864E466D617E825A5F18BBB4DD550BE3C9EB21AD751E87F09BD127969C1D32ADC4536914D282B7D04D106227D761E40845CDBDD8200C552AECEB75BBCF092AF048E4FF99AA61954D529B8C9795556CC0745B3BD9897CAA8524565026BAFA0124263AAA7026BA6CA4913A4DDA926F2FF0AAD707C74D4875658413B8268006DA45C2FB7D07FC668D05A2AC9A4542E94B446ED32C9AAB55A241CCD46CB85A331E64A69B2482A37D1E3934F7D20F60A2B16AFA2DB930F1FB5BAD5E805DBC36B37F26131CA1F438C261018F3FC00E2F8B730727E06F14B076BAD7649EF220CD51502FEB6F7DE1E5EC200DEEDC81A1EB2AFCEA6E6F1B7F01AD858755F05A4556B7A9F43FB5BB8435781438CACAFC8166D2E4D029DB093EA926B0C66E85CD0B69BA6D525B19F6B362ADDF5D778C3B8F080EBEBED177955F57E91D6104C404535535BB034EDBAB603EB18160C46236BBAE3DDB88E596ED3D665F573B871033D56F3AA6A56D31AB5AC66D54C5925C4F438CD6AAA194D2AD4F299D63265F3310241BCC616C70A124D216137AFF124583F25C7AA3A8255A6ACD8CA2ECB0D6E422959B75596D96DE1C7398FB777101DE6AD531BEDFD3AC234F1D6FDED50207B6069372ECDB8135D33EEF4F8797DFAE9C347E09C7EFC2B3CFD30BC49378C37660C1332993ED269EF164BD2D32FC0DB75DD55A3D59028AFEE57434276FAAB2161137F7E751DA2AFE6F52DF2CA98BC56FD1CCFA66B8EE36CE8E5C00C73E8CE87D1018D960BD9A4BA5F2D84EAF4178B1CCAD2AA64404D503F96F6CFF99D08E27223A80B776B4E6B4C3F52CE431348D06D87324238DB731444421BBAAF357DFF1EEFA43AB94E6A76B1A53C0309079BAE4F41FCD1ADF6B8D46A23EB7E13DB8F0D6C5FDCD9637BD308D2E49E097ABE9FB26A25BCC55201D8922A26903E8FE3D07613AEE44B3377EFB123BD0A1C4BCFD797CA5CE284C1338011EA926F982F3CF5331E6FF7C125F42082D6B99D3E32B900B10D1C51EE786C8E217F8597A4E44FE2D26039FC8BD0315E093022AD00B9C688F13A7303242E1B372057D59E96C4B8D69ACB8E08A1E8872FB984D87E2183D312890E034AC3755EF4C5CD509DA416730A8966002D5CBABA1010FDBBDA201521A0D18D046BC5F3A44AF22D8492B98D7579E57DC8BD0884BF362E3BC99E42F4258CCC31ADCB27EFA59E9A0AE3DCE30A1596F9A1065161ACC4465061AC48F64E85A5F711BAF3CF5D4E4C0D9EECAD88029DA9C53C083819718D804D461E9387A6F2D4A59AFEFA23588980D20DA3BF8BD45F748DB3001A61B36E3003C0B36EBE745890B87346012BFBF6548520C54354536BAC82A6AE49333E00A57CEB4CB9E28DA711F4A413D1B2F301502639A3AB60517560173742D926D8D3265DE126187E87564B6900FDA796844EE7F27B985E80983A6C701B845BC04854BD97CFA410BE2189EB110F2CF33EC699F78A470621BE8248784455FA8978ED2828439644FE52492090A9C29AE699F34B682DECE9357404378E8CA8C4D76340367FE85449363B7F1990CD5E2555524D57650DD1E2859184586982D510A9E346CA0905E59292EAC12055B9FA6921BFD6B4BD8FC5980A7809EB56DB5348D192418CD7C5AC241A48A95C91F57292BBC0CC9C60AD6425F8BA286AE5403A9751AE72EA2524F3879978C45A4987737C51B4F201742E995C45D54B46E61C33718FB5920CE7CA52ACB17C309D4B29D371F5429238680C5C34AD44C4BA531412CA06D25A40EA3B5751467A9E02335F01353C6A13AB9056AD77A04EF60D84C4453C8A92A938966A1C4C3554A7C651B40F2523BBAC14475F775CD23D30512390C25BF77CD3D192C96F500B83BC285BCCD3C8FDECC362AE08F15FDC82EDD60D3654C87FF6C55AA5F1FE17DFADCC63E1FD94C6DC66E4CC1F1F8A9E5018810DE44A71D798D36B378A1179D4F40C88BD7FE1F84235E9F1436148E65D72270C7112730B336F40FE2E9E9DB06FB2B2B3887854CBDA5EE3C1F9E4B0973C58129792D8D222891780072275E0FC45E8EDFCA02614BF8A16C15B19114F93634BF429322F8A68824C8101BDE47D0F4328F9A24F217F6644D3C8BFE953293C3D3419A5FB872C366EE28573B9002FC169C2C2550BCC4A73521FCAD2CD4103C88A765D095445277D42431349BFE853C8A3A0691AF9B7C94CAC6ABFD29FD71A6B4863866B29A824CC4FB3D90C6731BF8CB24B3F19D2A0C246056254993E5536B297A6C9961861910EDFE520491719704907E9324CD2058DE829242AAFA1DF8318964B53174BF5294B027469D292E206B4253CF36506DB9718C3CBEC6462B1D9F62FEACFF2EB64B49FC4B1D546158A5E567365A841A31F75985F6CF2536646858A82A309519F0D6965716E02B1ECFB24A1A47431358352EA596F0725050DB5CE6182C758955319F1A6A6C94484316ABD2A224E4DCF0CB0138085CAA9D60C15C97D443B50C849F4AB20F20B459A8AEA9271B4592B7D716D66ABB87A329F257553A56D43453931568D3272AA8A9AE4C10B631DD4BF87A940001598C4A080FA3E9E63A09B63BDBE7B61248477A78B5AEA21331DD4CEC4D13FD3F73D2BACD7959D1AF5C5A8F6219C6A5373D856B80989A7B95A250817AAA20CB56690272B7F6C42B1D38253E5BB97060ED1A70AC7A89A5FDEDFDE1A1CF95D873E34F21635C050DEE5D4089BBD479E2E28D83B6A4D3ED5CEC5A78A277BCDC120DCC1F0550A3D55DCC570772E8BECFEA33EF7B2702192569959B979BE9CADDE6304FD4352E170F5AB77E1B9906C8B79855B10B86B18A334DE727672747CC265709E4E36E5791C3B9EE4FE489252999DB3C1F317BB44C4B5E1E80D1264F0298B835710D92F20FA930FDEFEDC45C8774B825404B683FF46ED530BAFBD10A0B6998593F910DE1FDE040E7C5BCEFE99B439B36EFE912B8403EB3EC26BE3CC3AB2FED5557607D9F3EF4113D7F682C9D41663A15325E99BF86BE0FEBAC3D27E8C76904897CF6CDB2A6DAD097A1BA7776D3087ED62D04BC1F251E86D32A64AA92651E625D5E609529F5DF3452B4B8EAA9CD1C609505B51942439ED8A5E27225425316D424B99C054A6D975062B4F68DA84356532D344C9B54C65AAA3C7D21D236F997C3EA8566EDCCAEA2A3595E4BA610895D49B8123D37A1A1B77DA94DDB75B2A4B213760AB852EE6FF3320D722C75F0364EC597ABCCE764749F6BBCE688F09EDE629EF1A8047196AD957BAB8B1D5049B44CE889BB4E910332BBF9A18238D5B2F1B87E46AA3C1740854BAC58990DA6D6267F72E8EDD0DCEFFCDF298EDEF19AC99A549063D82A5A973F1A0277D2DEFB0D229A776DCD7CFA1ACE7F6DAE1A963F52019A899EB4A20D08713ABFEBEA15734547AED7F2F48E006D9C081D9A11BB3EBD47B1348052409AB1E3FC1DE904905AA5E3A4E2CD18FD1FDF5A451A7D8492B18D34EF8B22FF8D37BC5D07CBF181590B23B6931FE5127A3CFFF09004DA6BFF2D9C610F8D37A3F3202FC2A1E6EEC9336CC8294D56CE9E4DEDC5F4DA88AB2DB233D58F132879A76719EFBCF40364DD0E94F791739CD1AE3ADF699D40850334B943B01652749B8347E3ADCA10F1CAA7898891F388C92DE4E0C6B69F2ABD173DB0E8D34C5DBF68901CD3885EDF4B05666696B943D775FB0551111546BA04D3CE9ECB8F698C199782FAD2E9303E65E268F9D4ABED83137BB9A88AA69EC74A32784151337F1739A85B470CFF82B12BDA6910ECB99F31CE2794F2F3694591C79FA999A13A867DF65B41509CA78CAC2562CF421D490F596FE535AF264707C97922B0BA153499DEA6E152943ABFACE4E2F957D6775AAFB56A452ACEA3B5DE1955DA755AA7B96E75BE33B2E6D1CA1C3B248D691325DA0726C35E3AA1B93DE78547EDF3AE856AE45795D6366542B555E4D8311C53A1E3929309301502813F476E56DA62460972AE5F7D7CE7200173911F553012B220E7B105335C4AB826C7B14589EFCD14060F2D04799514D8D4C3194C90A884B6BAC9B38793434313A4A1D97DB9BA0F4715419402B1E0CA91149873049A1F49755BA1325CD58498A943FDD0BA5AF24D29D88843672E4F96EDA0BA4E7A4D15D8985372DD9C432EDC5D0595AE8261AC2606F9A5EE267294065E01C04E606899EC56402F878BF0BC8D3ECF4D7258CDD4D4962816906D0660EF6459D9B601DE6FE058EA3BC0AF79CF11622E090F4161172D7C046B898C4EE25FFBC71120F4522489FA17313DCEFD07687F090A1FFEC318144C44F51D57F92CD9AE579719F3C8D8FBB180266D325AFD9EF831F77AEE7147C5F4BDE512A4810074816F040E61291C087CD7B41E92E0C340965E22BFC368FD0DF7A98587C1FACC02B6CC21B86DF67B801F67B1959A522523F11ACD817972ED844C08F331A657BFC1363D8F1DFBEFF1F40DDC4CFF59C0000 , N'6.1.3-40302')

